import{_ as V,a8 as T,ay as L,q as b,H as e,R as s,G as u,E as k,U as y,D as o,a9 as S,p as c,J as B,K as D,S as g,P as f}from"./index-Dasq562Y.js";const U={name:"operator",data(){return{listQuery:{page:1,page_size:10,search:null,action:null,status:null},loading:!1,total:0,list:[],typeOptions:[{value:"login",label:"登录"},{value:"logout",label:"登出"},{value:"create",label:"创建"},{value:"update",label:"更新"},{value:"delete",label:"删除"},{value:"build",label:"构建"},{value:"run",label:"运行"},{value:"destroy",label:"销毁"},{value:"other",label:"其他"}]}},created(){this.getList()},methods:{getList(){this.loading=!0,T.get("/api/admin/operator",{params:this.listQuery}).then(t=>{this.list=t.results,this.total=t.total}).catch(t=>{L.error(t.message||"获取数据失败")}).finally(()=>{this.loading=!1})},handleFilter(){this.listQuery.page=1,this.getList()},handleSizeChange(t){this.listQuery.page_size=t,this.getList()},handleCurrentChange(t){this.listQuery.page=t,this.getList()},getTypeLabel(t){const a=this.typeOptions.find(_=>_.value===t);return a?a.label:t},getTypeTagType(t){return{login:"success",logout:"info",create:"primary",update:"warning",delete:"danger",build:"primary",run:"success",destroy:"danger",other:""}[t]||""}}},E={class:"main"},F={class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"},M={class:"page-r"};function N(t,a,_,O,n,i){const v=o("el-input"),p=o("el-form-item"),d=o("el-option"),h=o("el-select"),w=o("el-button"),C=o("el-form"),r=o("el-table-column"),m=o("el-tag"),Q=o("el-table"),z=o("el-pagination"),x=S("loading");return c(),b("div",E,[e(C,{class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]",inline:!0,model:n.listQuery},{default:s(()=>[e(p,null,{default:s(()=>[e(v,{modelValue:n.listQuery.search,"onUpdate:modelValue":a[0]||(a[0]=l=>n.listQuery.search=l),placeholder:"请输入操作内容",class:"w-[200px]",clearable:""},null,8,["modelValue"])]),_:1}),e(p,null,{default:s(()=>[e(h,{modelValue:n.listQuery.action,"onUpdate:modelValue":a[1]||(a[1]=l=>n.listQuery.action=l),placeholder:"操作类型",clearable:"",style:{width:"120px"}},{default:s(()=>[(c(!0),b(B,null,D(n.typeOptions,l=>(c(),y(d,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:s(()=>[e(h,{modelValue:n.listQuery.status,"onUpdate:modelValue":a[2]||(a[2]=l=>n.listQuery.status=l),placeholder:"操作状态",clearable:"",style:{width:"120px"}},{default:s(()=>[e(d,{label:"成功",value:"success"}),e(d,{label:"失败",value:"error"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:s(()=>[e(w,{type:"primary",onClick:i.handleFilter},{default:s(()=>a[3]||(a[3]=[g("查询")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),u("div",F,[a[4]||(a[4]=u("div",{class:"flex justify-between w-full page-title"},[u("p",{class:"font-bold truncate"},"审计日志")],-1)),u("div",null,[k((c(),y(Q,{data:n.list,fit:"","highlight-current-row":"",stripe:""},{default:s(()=>[e(r,{align:"center",label:"操作用户",prop:"operator",width:"120"}),e(r,{align:"center",label:"角色",prop:"role",width:"120"}),e(r,{align:"center",label:"操作类型",width:"120"},{default:s(l=>[e(m,{type:i.getTypeTagType(l.row.action),size:"small"},{default:s(()=>[g(f(i.getTypeLabel(l.row.action)),1)]),_:2},1032,["type"])]),_:1}),e(r,{align:"center",label:"操作内容",prop:"description","show-overflow-tooltip":"","min-width":"300"}),e(r,{align:"center",label:"IP地址",prop:"ip",width:"120"}),e(r,{align:"center",label:"状态",width:"100"},{default:s(l=>[e(m,{type:l.row.status==="success"?"success":"danger",size:"small"},{default:s(()=>[g(f(l.row.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),e(r,{align:"center",label:"操作时间",prop:"datetime",width:"180"})]),_:1},8,["data"])),[[x,n.loading]]),u("div",M,[e(z,{"current-page":n.listQuery.page,"page-size":n.listQuery.page_size,"page-sizes":[10,20,30,50],total:n.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}const P=V(U,[["render",N]]);export{P as default};
