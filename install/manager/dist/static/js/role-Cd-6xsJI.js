var V=Object.defineProperty;var C=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var y=(t,e,a)=>e in t?V(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,b=(t,e)=>{for(var a in e||(e={}))B.call(e,a)&&y(t,a,e[a]);if(C)for(var a of C(e))Q.call(e,a)&&y(t,a,e[a]);return t};var _=(t,e,a)=>new Promise((w,n)=>{var i=s=>{try{d(a.next(s))}catch(u){n(u)}},o=s=>{try{d(a.throw(s))}catch(u){n(u)}},d=s=>s.done?w(s.value):Promise.resolve(s.value).then(i,o);d((a=a.apply(t,e)).next())});import{_ as S,a8 as h,ay as m,az as q,D as c,a9 as N,p as k,q as T,H as l,R as r,S as g,G as f,E as U,U as j}from"./index-Dasq562Y.js";const F={name:"role",data(){return{listQuery:{page:1,page_size:10},loading:!1,list:[],total:0,currentRow:{name:""},currentEdit:!1,rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}}},created(){this.fetchData()},methods:{fetchData(){this.loading=!0,h.get("/api/admin/role").then(t=>{const{data:e}=t;this.list=e}).catch(t=>{m.error(t.message||"获取数据失败")}).finally(()=>{this.loading=!1})},handleSizeChange(t){this.listQuery.page_size=t,this.fetchData()},handleCurrentChange(t){this.listQuery.page=t,this.fetchData()},handleCreate(){this.currentEdit=!0,this.currentRow={name:""}},handleEdit(){this.currentEdit=!1,this.fetchData()},itemEdit(t){this.currentRow=b({},t),this.currentEdit=!0},itemDelete(t){return _(this,null,function*(){try{yield q.confirm("确认要删除该角色吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield h.delete(`/api/admin/role/${t.id}`),m({type:"success",message:"删除成功",duration:2e3}),this.fetchData()}catch(e){e!=="cancel"&&m.error("删除失败")}})},cancel(){this.currentEdit=!1},submit(){return _(this,null,function*(){try{yield this.$refs.dataForm.validate(),this.currentRow.id?(yield h.put("/api/admin/role",this.currentRow),m({type:"success",message:"修改成功",duration:2e3})):(yield h.post("/api/admin/role",this.currentRow),m({type:"success",message:"添加成功",duration:2e3})),this.currentEdit=!1,this.fetchData()}catch(t){t!=="cancel"&&m.error(t.message||"操作失败")}})}}},M={class:"main"},G={class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"},H={class:"page-r"},I={class:"dialog-footer"};function A(t,e,a,w,n,i){const o=c("el-button"),d=c("el-form-item"),s=c("el-form"),u=c("el-table-column"),x=c("el-table"),E=c("el-pagination"),v=c("el-input"),D=c("el-dialog"),z=N("loading");return k(),T("div",M,[l(s,{class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]",inline:!0},{default:r(()=>[l(d,null,{default:r(()=>[l(o,{type:"primary",onClick:i.fetchData},{default:r(()=>e[2]||(e[2]=[g("查询")])),_:1},8,["onClick"]),l(o,{type:"success",onClick:i.handleCreate},{default:r(()=>e[3]||(e[3]=[g("添加")])),_:1},8,["onClick"])]),_:1})]),_:1}),f("div",G,[e[6]||(e[6]=f("div",{class:"flex justify-between w-full h-[60px] p-4"},[f("p",{class:"font-bold truncate"},"角色管理")],-1)),f("div",null,[U((k(),j(x,{data:n.list,"highlight-current-row":"",stripe:""},{default:r(()=>[l(u,{label:"角色ID",prop:"id",align:"center","class-name":"fnt-12"}),l(u,{label:"角色名",prop:"name",align:"center","class-name":"fnt-12"}),l(u,{label:"操作",width:"200",align:"center"},{default:r(p=>[l(o,{link:"",type:"primary",onClick:R=>i.itemEdit(p.row)},{default:r(()=>e[4]||(e[4]=[g("编辑")])),_:2},1032,["onClick"]),l(o,{link:"",type:"danger",onClick:R=>i.itemDelete(p.row)},{default:r(()=>e[5]||(e[5]=[g("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[z,n.loading]]),f("div",H,[l(E,{"current-page":n.listQuery.page,"page-size":n.listQuery.page_size,"page-sizes":[10,20,30,50],total:n.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])]),l(D,{modelValue:n.currentEdit,"onUpdate:modelValue":e[1]||(e[1]=p=>n.currentEdit=p),title:n.currentRow.id?"编辑角色":"新增角色",width:"500px"},{footer:r(()=>[f("span",I,[l(o,{onClick:i.cancel},{default:r(()=>e[7]||(e[7]=[g("取 消")])),_:1},8,["onClick"]),l(o,{type:"primary",onClick:i.submit},{default:r(()=>e[8]||(e[8]=[g("确 定")])),_:1},8,["onClick"])])]),default:r(()=>[l(s,{ref:"dataForm",model:n.currentRow,"label-width":"100px",rules:n.rules},{default:r(()=>[l(d,{label:"角色名称",prop:"name",required:""},{default:r(()=>[l(v,{modelValue:n.currentRow.name,"onUpdate:modelValue":e[0]||(e[0]=p=>n.currentRow.name=p),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}const L=S(F,[["render",A]]);export{L as default};
